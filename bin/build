#!/bin/bash

scriptArguments=()
createDevDoc=0;
createUserDoc=0;

if [ $# -gt 0 ]; then
    for var in "$@"
    do
        if [[ $var == -* ]]; then
            # Entwicklerdoku erzeugen
            if [[ $var == "-devdoc" ]]; then
                createDevDoc=1
            fi
            # Benutzerdoku erzeugen
            if [[ $var == "-userdoc" ]]; then
                createUserDoc=1
            fi
        else
            scriptArguments+=($var)
        fi
    done
fi

# Rufe das Skript compile auf
bin/compile "${scriptArguments[@]/#/}"
# ZurÃ¼ck ins QSB-Verzeichnis
cd qsb

# Erzeuge Entwicklerdokumentation
if [ $createDevDoc -gt 0 ]; then
    echo "Erzeuge Entwicklerdokumentation ..."
    rm -r ../doc &>/dev/null
    lua ldoc/ldoc.lua -d ../doc -a lua &>/dev/null
    echo "Fertig!"
fi

# Erzeuge Benutzerdokumentation
if [ $createUserDoc -gt 0 ]; then
    echo "Erzeuge Benutzerdokumentation ..."
    lua lua/documenter.lua &>/dev/null
    echo "Fertig!"
fi